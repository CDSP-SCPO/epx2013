(function(o){var l={minWidth:675,itemWidth:95,columns:5,rows:undefined,title:undefined,prompt:"Select countries",maxDisplay:0,openSpeed:400,closeSpeed:400,openEffect:"slide",closeEffect:"slide",hideOnMouseOut:true};function k(a){if(typeof a=="undefined"){return false}else{return true}}function j(a,b){if(k(b.columns)&&k(b.rows)){o.error("gentleSelect: You cannot supply both 'rows' and 'columns'");return true}if(k(b.columns)&&!k(b.itemWidth)){o.error("gentleSelect: itemWidth must be supplied if 'columns' is specified");return true}if(k(b.rows)&&!k(b.itemWidth)){o.error("gentleSelect: itemWidth must be supplied if 'rows' is specified");return true}if(!k(b.openSpeed)||typeof b.openSpeed!="number"&&(typeof b.openSpeed=="string"&&(b.openSpeed!="slow"&&b.openSpeed!="fast"))){o.error('gentleSelect: openSpeed must be an integer or "slow" or "fast"');return true}if(!k(b.closeSpeed)||typeof b.closeSpeed!="number"&&(typeof b.closeSpeed=="string"&&(b.closeSpeed!="slow"&&b.closeSpeed!="fast"))){o.error('gentleSelect: closeSpeed must be an integer or "slow" or "fast"');return true}if(!k(b.openEffect)||(b.openEffect!="fade"&&b.openEffect!="slide")){o.error("gentleSelect: openEffect must be either 'fade' or 'slide'!");return true}if(!k(b.closeEffect)||(b.closeEffect!="fade"&&b.closeEffect!="slide")){o.error("gentleSelect: closeEffect must be either 'fade' or 'slide'!");return true}if(!k(b.hideOnMouseOut)||(typeof b.hideOnMouseOut!="boolean")){o.error('gentleSelect: hideOnMouseOut must be supplied and either "true" or "false"!');return true}return false}function m(a,b){if(a.attr("multiple")){b.hideOnMouseOut=true}}function p(b,a){if(b.length<1){return a.prompt}if(a.maxDisplay!=0&&b.length>a.maxDisplay){var c=b.slice(0,a.maxDisplay).map(function(){return o(this).text()});c.push("...")}else{var c=b.map(function(){return o(this).text()})}return c.get().join(", ")}var i={init:function(x){var f=o.extend({},l,x);if(j(this,f)){return this}m(this,f);this.hide();label_text=p(this.find(":selected"),f);var B=o("<span class='gentleselect-label'>"+label_text+"</span>").insertBefore(this).bind("mouseenter.gentleselect",n.labelHoverIn).bind("mouseleave.gentleselect",n.labelHoverOut).bind("click.gentleselect",n.labelClick).data("root",this);this.data("label",B).data("options",f);var c=o("<ul></ul>");this.find("option").each(function(){var q=o("<li>"+o(this).text()+"</li>").data("value",o(this).attr("value")).data("name",o(this).text()).appendTo(c);if(o(this).attr("selected")){q.addClass("selected")}});var b=o("<div class='gentleselect-dialog'></div>").append(c).insertAfter(B).bind("click.gentleselect",n.dialogClick).bind("mouseleave.gentleselect",n.dialogHoverOut).data("label",B).data("root",this);this.data("dialog",b);if(k(f.columns)||k(f.rows)){c.css("float","left").find("li").width(f.itemWidth).css("float","left");var d=c.find("li:first");var g=f.itemWidth+parseInt(d.css("padding-left"))+parseInt(d.css("padding-right"));var A=c.find("li").length;if(k(f.columns)){var a=parseInt(f.columns);var y=Math.ceil(A/a)}else{var y=parseInt(f.rows);var a=Math.ceil(A/y)}b.width(675);for(var e=0;e<(y*a)-A;e++){o("<li style='float:left' class='gentleselect-dummy'><span>&nbsp;</span></li>").appendTo(c)}var h=[];var z=0;c.find("li").each(function(){if(z<y){h[z]=o(this)}else{var q=z%y;o(this).insertAfter(h[q]);h[q]=o(this)}z++})}else{if(typeof f.minWidth=="number"){b.css("min-width",f.minWidth)}}if(k(f.title)){o("<div class='gentleselect-title'>"+f.title+"</div>").prependTo(b)}o(document).bind("keyup.gentleselect",n.keyUp);return this},update:function(){var a=this.data("options");var c=(this.attr("multiple"))?this.val():[this.val()];o("li",this.data("dialog")).each(function(){var d=o(this);var e=(o.inArray(d.data("value"),c)!=-1);d.toggleClass("selected",e)});var b=p(this.find(":selected"),a);this.data("label").text(b);return this}};var n={labelHoverIn:function(){o(this).addClass("gentleselect-label-highlight")},labelHoverOut:function(){o(this).removeClass("gentleselect-label-highlight")},labelClick:function(){var b=o(this);var a=b.position();var e=b.data("root");var c=e.data("options");var d=e.data("dialog").css("right",54);if(c.openEffect=="fade"){d.fadeIn(c.openSpeed)}else{d.slideDown(c.openSpeed)}},dialogHoverOut:function(){var a=o(this);if(a.data("root").data("options").hideOnMouseOut){a.hide()}},dialogClick:function(h){var f=o(h.target);var g=o(this);var e=g.data("root");var t=e.data("options");if(!e.attr("multiple")){if(t.closeEffect=="fade"){g.fadeOut(t.closeSpeed)}else{g.slideUp(t.closeSpeed)}}if(f.is("li")&&!f.hasClass("gentleselect-dummy")){var c=f.data("value");var s=f.data("name");var d=g.data("label");if(g.data("root").attr("multiple")){f.toggleClass("selected");var a=g.find("li.selected");d.text(p(a,t));var b=a.map(function(){return o(this).data("value")});e.val(b.get()).trigger("change")}else{g.find("li.selected").removeClass("selected");f.addClass("selected");d.text(f.data("name"));e.val(c).trigger("change")}}},keyUp:function(a){if(a.keyCode==27){o(".gentleselect-dialog").hide()}}};o.fn.gentleSelect=function(a){if(i[a]){return i[a].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof a==="object"||!a){return i.init.apply(this,arguments)}else{o.error("Method "+a+" does not exist on jQuery.gentleSelect")}}}})(jQuery);